<nb-card status="info" class="position-center" style="max-width: 600px; height: 80vh;">
    <nb-card-header>
        <span class="subtitle" style="margin-left: 0.5em;">{{ action == "view" ? "User Details" : "Edit User"
            }}</span>
        <span style="float: right;">
            <nb-icon class="cursor-pointer" (click)="close(2)" icon="close-circle-outline"></nb-icon>
        </span>
    </nb-card-header>
    <nb-card-body>
        <form [formGroup]="editUserForm" (ngSubmit)="onSubmit()">
            <div class="form-group row" style="height:60px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">First Name</label>
                <div class="col-sm-8">
                    <input [status]="form.firstName.invalid && submitted? 'danger' : 'basic'" type="text" nbInput
                        fullWidth formControlName="firstName" [attr.disabled]="action == 'view' ? '' : null"
                        style="color:black" />
                    <ng-container *ngIf="submitted && form.firstName.errors">
                        <p class="caption status-danger" *ngIf="form.firstName.errors?.required">
                            *Required!
                        </p>
                    </ng-container>
                </div>
            </div>
            <div class="form-group row" style="height:60px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">Last Name</label>
                <div class="col-sm-8">
                    <input [status]="form.lastName.invalid && submitted? 'danger' : 'basic'" type="text" nbInput
                        fullWidth formControlName="lastName" [attr.disabled]="action == 'view' ? '' : null"
                        style="color:black" />
                    <ng-container *ngIf="submitted && form.lastName.errors">
                        <p class="caption status-danger" *ngIf="form.lastName.errors?.required">
                            *Required!
                        </p>
                    </ng-container>
                </div>
            </div>
            <div class="form-group row" style="height:60px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">Email</label>
                <div class="col-sm-8">
                    <input [status]="form.email.invalid && submitted? 'danger' : 'basic'" type="email" email="true"
                        nbInput fullWidth formControlName="email" [attr.disabled]="action == 'view' ? '' : null"
                        style="color:black" />
                    <ng-container *ngIf="submitted && form.email.errors">
                        <p class="caption status-danger" *ngIf="form.email.errors?.required">
                            *Required!
                        </p>
                        <p class="caption status-danger" *ngIf="form.email.errors?.email">
                            Email format not correct
                        </p>
                    </ng-container>
                </div>
            </div>
            <div class="form-group row" style="height:60px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">User Name</label>
                <div class="col-sm-8">
                    <input [status]="form.userName.invalid && submitted? 'danger' : 'basic'" type="text" nbInput
                        fullWidth formControlName="userName" [attr.disabled]="action == 'view' ? '' : null"
                        style="color:black" />
                    <ng-container *ngIf="submitted && form.userName.errors">
                        <p class="caption status-danger" *ngIf="form.userName.errors?.required">
                            *Required!
                        </p>
                    </ng-container>
                </div>
            </div>
            <ng-container *ngIf="action != 'view'">
                <div class="form-group row" style="height:60px;">
                    <label for="inputEmail1" class="label col-sm-4 col-form-label">Password</label>
                    <div class="col-sm-8">
                        <div class="input-group ">
                            <input nbInput formControlName="password" name="password"
                                [type]="isShowPassword ? 'text' : 'Password'" id="input-password"
                                class="form-control size-large shadow-none" style="border-radius: 2px 0px 0px 2px"
                                [status]="form.password.invalid && submitted ? 'danger' : 'basic'" maxlength="30"
                                [attr.disabled]="action == 'view' ? '' : null" style="color:black" (ngModelChange)="addAndRemoveValidator($event)"/>
                            <div class="input-group-append">
                                <span class="input-group-text"
                                    style="padding: 0;background-color:#F7F9FC; border-color: #E4E9F2; ">
                                    <button class="shadow-none" nbButton type="button" (click)="toggleShowPassword()"
                                        size="small" style="background-color:#F7F9FC ; border-color: #F7F9FC;"
                                        [attr.disabled]="action == 'view' ? '' : null">
                                        <nb-icon [icon]="isShowPassword ? 'eye-outline' : 'eye-off-2-outline'"
                                            pack="eva"
                                            [attr.aria-label]="isShowPassword ? 'hide password' : 'show password'">
                                        </nb-icon>
                                    </button>
                                </span>
                            </div>
                        </div>
                        <ng-container *ngIf="submitted && form.password.errors">
                            <p class="caption status-danger" *ngIf="form.password.errors?.required">
                                *Required!
                            </p>
                            <p class="caption status-danger" *ngIf="form.password.errors?.pattern">
                                *At least 8 characters in length, Lowercase letters, Uppercase letters, Numbers, Special
                                characters(@$!%*?#&)
                            </p>
                        </ng-container>
                    </div>
                </div>
                <div class="form-group row" style="height:60px;">
                    <label for="inputEmail1" class="label col-sm-4 col-form-label">Re-Password</label>
                    <div class="col-sm-8">
                        <div class="input-group ">
                            <input nbInput formControlName="reEnterPassword" name="reEnterPassword"
                                [type]="isShowReEnterPassword ? 'text' : 'Password'" id="input-password"
                                class="form-control size-large shadow-none" style="border-radius: 2px 0px 0px 2px"
                                [status]="form.reEnterPassword.invalid && submitted ? 'danger' : 'basic'" maxlength="30"
                                [attr.disabled]="action == 'view' ? '' : null" style="color:black" (ngModelChange)="addAndRemoveValidator($event)"/>
                            <div class="input-group-append">
                                <span class="input-group-text"
                                    style="padding: 0;background-color:#F7F9FC; border-color: #E4E9F2; ">
                                    <button class="shadow-none" nbButton type="button"
                                        (click)="toggleShowReEnterPassword()" size="small"
                                        style="background-color:#F7F9FC ; border-color: #F7F9FC;"
                                        [attr.disabled]="action == 'view' ? '' : null">
                                        <nb-icon [icon]="isShowReEnterPassword ? 'eye-outline' : 'eye-off-2-outline'"
                                            pack="eva"
                                            [attr.aria-label]="isShowReEnterPassword ? 'hide password' : 'show password'">
                                        </nb-icon>
                                    </button>
                                </span>
                            </div>
                        </div>
                        <ng-container *ngIf="submitted && form.reEnterPassword.errors">
                            <p class="caption status-danger" *ngIf="form.reEnterPassword.errors?.required">
                                *Required!
                            </p>
                            <p class="caption status-danger" *ngIf="form.reEnterPassword.errors?.mustMatch">
                                *Passwords must match!
                            </p>
                            <p class="caption status-danger" *ngIf="form.reEnterPassword.errors?.pattern">
                                *At least 8 characters in length, Lowercase letters, Uppercase letters, Numbers, Special
                                characters(@$!%*?#&)
                            </p>
                        </ng-container>
                    </div>
                </div>
            </ng-container>

            <div class="form-group row" style="height:60px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">Role</label>
                <div class="col-sm-8">
                    <ng-container *ngIf="action == 'view'">
                        <input type="text" nbInput fullWidth maxlength="30" style="text-indent: -9999em;
                            text-shadow : 9999em 0 0 #000; color:black" [attr.disabled]="action == 'view' ? '' : null"
                            formControlName="role">
                    </ng-container>
                    <ng-container *ngIf="action == 'edit'">
                        <nb-select formControlName="role" [status]="form.role.invalid && submitted? 'danger' : ''"
                            style="width: 100%; max-width: 100%;">
                            <nb-option *ngFor="let e of roles" [value]="e.value"> {{ e.name }} </nb-option>
                        </nb-select>
                        <!-- <nb-select formControlName="Role" [status]="form.Role.invalid && submitted? 'danger' : ''"
                            style="width: 100%; max-width: 100%;">

                            <nb-option *ngIf="userRole == 'MASTER ADMIN'" value="MASTER ADMIN">
                                MASTER ADMIN
                            </nb-option>

                            <nb-option value="ADMIN">
                                ADMIN
                            </nb-option>
                            <nb-option value="NORMAL">
                                NORMAL
                            </nb-option>
                        </nb-select> -->
                    </ng-container>

                    <ng-container *ngIf="submitted && form.role.errors">
                        <p class="caption status-danger" *ngIf="form.role.errors?.required">
                            *Required!
                        </p>
                        <p class="caption status-danger" *ngIf="form.role.errors?.noPermission">
                            *You have no permissions to assign roles. Please contact with administration!
                        </p>
                    </ng-container>
                </div>
            </div>


            <!-- <div class="form-group row" style="height:90px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">Role</label>
                <div class="col-sm-8">
                    <ng-container *ngIf="action == 'view'">
                        <input type="text" nbInput fullWidth formControlName="" maxlength="30" style="text-indent: -9999em;
                            text-shadow : 9999em 0 0 #000; color:black" disabled formControlName="Role">
                    </ng-container>
                    <ng-container *ngIf="action == 'edit'">
                        <mat-radio-group formControlName="Role" style="display: flex; flex-direction: column;"
                            [disabled]="action == 'view' ? '' : null">
                            <mat-radio-button value="MASTER ADMIN" color="primary" style="margin: 5px;">MASTER ADMIN
                            </mat-radio-button>
                            <mat-radio-button value="ADMIN" color="primary" style="margin: 5px;">ADMIN
                            </mat-radio-button>
                            <mat-radio-button value="NORMAL" color="primary" style="margin: 5px;">NORMAL
                            </mat-radio-button>
                        </mat-radio-group>
                        <ng-container *ngIf="submitted && form.Role.errors">
                            <p class="caption status-danger" *ngIf="form.Role.errors?.required">
                                *Required!
                            </p>
                        </ng-container>
                    </ng-container>

                </div>
            </div> -->
            <div class="form-group row" style="height:90px;">
                <label for="inputEmail1" class="label col-sm-4 col-form-label">Status</label>
                <div class="col-sm-8">
                    <ng-container *ngIf="action == 'view'">
                        <div style="font-weight: bold; padding-left: 10px;">
                            {{ editUserForm.value.isActive ? "Active" : "Inactive" }}
                        </div>
                    </ng-container>
                    <ng-container *ngIf="action == 'edit'">
                        <mat-radio-group formControlName="isActive" style="display: flex; flex-direction: column;"
                            [attr.disabled]="action == 'view' ? '' : null">
                            <mat-radio-button [value]="true" color="primary" style="margin: 5px;">ACTIVE
                            </mat-radio-button>
                            <mat-radio-button [value]="false" color="primary" style="margin: 5px;">INACTIVE
                            </mat-radio-button>
                        </mat-radio-group>
                        <ng-container *ngIf="submitted && form.isActive.errors">
                            <p class="caption status-danger" *ngIf="form.isActive.errors?.required">
                                *Required!
                            </p>
                        </ng-container>
                    </ng-container>

                </div>
            </div>
            <div class="form-group row">
                <div class="position-center" style=" text-align: center;">
                    <ng-container *ngIf="action == 'edit' ">
                        <button nbButton status="primary" type="submit" size="medium" style="margin-right: 20px;">
                            Update
                        </button>
                    </ng-container>
                    <button nbButton status="danger" type="button" (click)="close(2)" size="medium">
                        Close
                    </button>
                </div>
            </div>
        </form>
    </nb-card-body>
</nb-card>